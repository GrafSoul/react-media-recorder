(this["webpackJsonpreact-media-recorder"]=this["webpackJsonpreact-media-recorder"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n(1),r=n.n(i),a=n(5),o=n.n(a),s=(n(12),n(13),n(2));n(15);function l(){var e=Object(i.useRef)(null),t=Object(i.useRef)(null),n=Object(i.useRef)(null),r=Object(i.useRef)(null),a=Object(i.useRef)(null),o=Object(i.useRef)(null);function s(t){r.current=e.current.createMediaStreamSource(t),a.current=function(e,t,n,c){var i=e.createScriptProcessor(256);return i.onaudioprocess=u,i.clipping=!1,i.lastClip=0,i.volume=0,i.clipLevel=t||.98,i.averaging=n||.95,i.clipLag=c||750,i.connect(e.destination),i.checkClipping=function(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)},i.shutdown=function(){this.disconnect(),this.onaudioprocess=null},i}(e.current),r.current.connect(a.current),l()}function l(){return n.current.clearRect(0,0,400,10),a.current.checkClipping()?n.current.fillStyle="red":n.current.fillStyle="green",n.current.fillRect(0,0,400*a.current.volume*1.4,10),o.current=window.requestAnimationFrame(l),o.current}function u(e){for(var t,n=e.inputBuffer.getChannelData(0),c=n.length,i=0,r=0;r<c;r++)t=n[r],Math.abs(t)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),i+=t*t;var a=Math.sqrt(i/c);this.volume=Math.max(a,this.volume*this.averaging)}return Object(i.useEffect)((function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,n.current=t.current.getContext("2d"),window.AudioContext=window.AudioContext||window.webkitAudioContext,e.current=new AudioContext;try{navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},s,(function(){alert("Stream generation failed.")}))}catch(c){alert("getUserMedia threw exception :"+c)}})),Object(c.jsx)("div",{children:Object(c.jsx)("canvas",{className:"audio-indicator",id:"meter",height:"10",ref:t})})}var u=function(e){var t=e.list,n=e.deleteEntry;return Object(c.jsx)("ul",{className:"list-media",children:t.map((function(e,t){return Object(c.jsxs)("li",{children:[e,Object(c.jsx)("button",{className:"btn btn-danger",onClick:function(){return n(t)},children:"X"})]},t)}))})},d=(n(14),function(){var e=Object(i.useRef)(),t=Object(i.useRef)(),n=Object(i.useRef)(),r=Object(i.useRef)(),a=Object(i.useRef)(),o=Object(i.useRef)(null),d=Object(i.useRef)([]),j=Object(i.useState)([]),b=Object(s.a)(j,2),h=b[0],f=b[1],v=Object(i.useState)(!1),p=Object(s.a)(v,2),m=p[0],O=p[1],g=Object(i.useState)(!0),x=Object(s.a)(g,2),w=x[0],C=x[1],S=Object(i.useState)(!1),N=Object(s.a)(S,2),k=N[0],y=N[1],R=Object(i.useState)(!1),M=Object(s.a)(R,2),F=M[0],E=M[1],A=Object(i.useState)(0),D=Object(s.a)(A,2),I=D[0],L=D[1];Object(i.useEffect)((function(){var c=[t.current,n.current,r.current];n.current.disabled=!("sinkId"in HTMLMediaElement.prototype);var i=function(e){var i=c.map((function(e){return e.value}));c.forEach((function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}));for(var a=0;a!==e.length;++a){var o=e[a],s=document.createElement("option");s.value=o.deviceId,"audioinput"===o.kind?(s.text=o.label||"microphone ".concat(t.current.length+1),t.current.appendChild(s)):"audiooutput"===o.kind?(s.text=o.label||"speaker ".concat(n.current.length+1),n.current.appendChild(s)):"videoinput"===o.kind?(s.text=o.label||"camera ".concat(r.current.length+1),r.current.appendChild(s)):console.log("Some other kind of source/device: ",o)}c.forEach((function(e,t){Array.prototype.slice.call(e.childNodes).some((function(e){return e.value===i[t]}))&&(e.value=i[t])}))},o=function(e){P(),console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)};navigator.mediaDevices.enumerateDevices().then(i).catch(o);var s=function(){var e=t.current.value,n=r.current.value;a.current={audio:{deviceId:e?{exact:e}:void 0},video:!m&&{deviceId:n?{exact:n}:void 0}},navigator.mediaDevices.getUserMedia(a.current).then(B).then(i).catch(o)};t.current.onchange=s,n.current.onchange=function(){var t=n.current.value;U(e.current,t)},r.current.onchange=s,s()}),[m]);var U=function(e,t){"undefined"!==typeof e.sinkId?e.setSinkId(t).then((function(){console.log("Success, audio output device attached: ".concat(t))})).catch((function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: ".concat(e)),console.error(t),n.current.selectedIndex=0})):console.warn("Browser does not support output device selection.")},B=function(t){return e.current.srcObject=t,o.current=new window.MediaRecorder(t),navigator.mediaDevices.enumerateDevices()},P=function(){C(!1),O(!0)},T=function(){E(!F)};return Object(c.jsxs)("div",{className:"container",children:[Object(c.jsxs)("div",{className:"header-content",children:[Object(c.jsx)("h1",{children:"Media Recorder"}),Object(c.jsxs)("h2",{children:["Configure your ",m?null:"camera and "," audio devices"]})]}),Object(c.jsxs)("div",{className:["control-wrap",F?"hidden":null].join(" "),children:[w&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"select-title",children:"Selecting a record type"}),Object(c.jsxs)("div",{className:"control",onChange:function(e){return function(e){"audio"===e.target.value?O(!0):O(!1)}(e)},children:[Object(c.jsx)("input",{type:"radio",name:"media",value:"video",id:"mediaVideo",defaultChecked:!m}),Object(c.jsx)("label",{htmlFor:"media",children:"Video"}),Object(c.jsx)("input",{type:"radio",name:"media",value:"audio",defaultChecked:m}),Object(c.jsx)("label",{htmlFor:"media",children:"Audio"})]})]}),Object(c.jsxs)("div",{className:"settings",children:[Object(c.jsxs)("div",{className:["video-settings",m?"invisible":null].join(" "),children:[Object(c.jsx)("div",{className:"video-content",children:Object(c.jsx)("video",{id:"video",poster:"images/poster.png",autoPlay:!0,playsInline:!0,ref:e})}),Object(c.jsxs)("div",{className:"select",children:[Object(c.jsx)("label",{htmlFor:"videoSource",children:"Video source:"}),Object(c.jsx)("select",{id:"videoSource",ref:r})]})]}),Object(c.jsxs)("div",{className:"audio-settings",children:[Object(c.jsxs)("div",{className:"select",children:[Object(c.jsx)("label",{htmlFor:"audioSource",children:"Audio input:"}),Object(c.jsx)(l,{}),Object(c.jsx)("select",{id:"audioSource",ref:t})]}),Object(c.jsxs)("div",{className:"select",children:[Object(c.jsx)("label",{htmlFor:"audioOutput",children:"Audio output:"}),Object(c.jsx)("select",{id:"audioOutput",ref:n})]})]})]})]}),F?Object(c.jsxs)("div",{className:"record-btns",children:[Object(c.jsx)("button",{disabled:!!k,className:["btn","btn-success",k?"active":null].join(" "),onClick:function(){o.current.start(),y(!0)},children:"Record"}),Object(c.jsx)("button",{disabled:!k,className:"btn btn-info",onClick:function(){o.current.stop(),o.current.ondataavailable=function(e){d.current=[],d.current.push(e.data),"inactive"===o.current.state&&function(){var e=new Blob(d.current,{type:m?"audio":"video"}),t=URL.createObjectURL(e),n=I+1,i=m?Object(c.jsxs)("span",{children:[n,".",Object(c.jsx)("audio",{controls:!0,children:Object(c.jsx)("source",{src:t,type:"audio/mp3"})}),Object(c.jsxs)("a",{className:"btn btn-info",href:t,download:"".concat(n,".mp3"),children:["Download - ",n,".mp3"]})]},n):Object(c.jsxs)("span",{children:[n,".",Object(c.jsx)("video",{controls:!0,children:Object(c.jsx)("source",{src:t,type:"video/webm"})}),Object(c.jsxs)("a",{className:"btn btn-info",href:t,download:"".concat(n,".mp4"),children:["Download - ",n,".mp4"]})]},n),r=h;r.push(i),f(r),L(I+1)}()},y(!1)},children:"Stop"}),Object(c.jsx)("button",{disabled:!!k,className:"btn btn-info",onClick:T,children:"Settings"})]}):Object(c.jsx)("div",{className:"record-btns",children:Object(c.jsx)("button",{className:"btn btn-info",onClick:T,children:"Start Recording"})}),Object(c.jsxs)("div",{className:"footer-content",children:[Object(c.jsxs)("h2",{children:["List of media records (",I,")"]}),Object(c.jsx)(u,{list:h,deleteEntry:function(e){var t=h;t.splice(e,1),f(t),L(I-1)}})]})]})});var j=function(){return Object(c.jsx)(d,{})},b=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(j,{})}),document.getElementById("root")),b()}},[[16,1,2]]]);
//# sourceMappingURL=main.e4e862d3.chunk.js.map